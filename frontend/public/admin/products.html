<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√úr√ºn Y√∂netimi - 3D Market</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Arial', sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .nav-content { display: flex; justify-content: space-between; align-items: center; }
        .nav-brand h2 { color: #007bff; font-size: 1.8rem; }
        .nav-brand a { text-decoration: none; color: inherit; }
        .nav-links a { text-decoration: none; color: #333; font-weight: 500; padding: 0.5rem 1rem; }
        
        /* Admin Paneli Stilleri */
        .admin-container { display: grid; grid-template-columns: 250px 1fr; gap: 2rem; margin: 2rem 0; }
        .admin-sidebar { background: white; border-radius: 10px; padding: 1.5rem; box-shadow: 0 2px 10px rgba(0,0,0,0.1); height: fit-content; }
        .sidebar-menu { display: flex; flex-direction: column; gap: 0.5rem; }
        .sidebar-btn { background: none; border: none; padding: 1rem; text-align: left; border-radius: 5px; cursor: pointer; transition: background 0.3s; }
        .sidebar-btn:hover, .sidebar-btn.active { background: #007bff; color: white; }
        .admin-content { background: white; border-radius: 10px; padding: 2rem; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .admin-section { display: none; }
        .admin-section.active { display: block; }
        
        /* Form Stilleri */
        .form-group { margin-bottom: 1.5rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; }
        .form-group input, .form-group textarea, .form-group select { 
            width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 5px; font-size: 1rem; 
        }
        .form-group input:focus, .form-group textarea:focus, .form-group select:focus { 
            outline: none; border-color: #007bff; 
        }
        
        /* Buton Stilleri */
        .btn-primary { background: #007bff; color: white; border: none; padding: 12px 20px; border-radius: 5px; cursor: pointer; }
        .btn-primary:hover { background: #0056b3; }
        .btn-danger { background: #dc3545; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; }
        .btn-danger:hover { background: #c82333; }
        .btn-secondary { background: #6c757d; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; }
        .btn-secondary:hover { background: #545b62; }
        
        /* √úr√ºn Listesi */
        .products-list { display: flex; flex-direction: column; gap: 1rem; }
        .product-item { 
            background: #f8f9fa; padding: 1.5rem; border-radius: 10px; border-left: 4px solid #007bff;
            display: flex; justify-content: space-between; align-items: start;
        }
        .product-info { flex: 1; }
        .product-actions { display: flex; gap: 0.5rem; }
        
        /* Mesaj Stilleri */
        .message { padding: 1rem; border-radius: 5px; margin: 1rem 0; text-align: center; }
        .message.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .message.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="container">
                <div class="nav-content">
                    <div class="nav-brand">
                        <h2><a href="../index.html">3D Market - Admin</a></h2>
                    </div>
                    <div class="nav-links">
                        <a href="../index.html">Siteye D√∂n</a>
                        <a href="#" id="logoutBtn">√áƒ±kƒ±≈ü Yap</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container">
        <div class="admin-container">
            <!-- Sidebar -->
            <div class="admin-sidebar">
                <div class="sidebar-menu">
                    <button class="sidebar-btn active" onclick="showSection('addProduct')">√úr√ºn Ekle</button>
                    <button class="sidebar-btn" onclick="showSection('viewProducts')">√úr√ºnleri Y√∂net</button>
                    <button class="sidebar-btn" onclick="showSection('viewOrders')">Sipari≈üler</button>
                </div>
            </div>

            <!-- Ana ƒ∞√ßerik -->
            <div class="admin-content">
                <!-- √úr√ºn Ekleme B√∂l√ºm√º -->
                <div id="addProduct" class="admin-section active">
                    <h2>Yeni √úr√ºn Ekle</h2>
                    <form id="addProductForm">
                        <div class="form-group">
                            <label for="productName">√úr√ºn Adƒ±:</label>
                            <input type="text" id="productName" required placeholder="√ñrnek: Modern Sandalye">
                        </div>
                        <div class="form-group">
                            <label for="productPrice">Fiyat ($):</label>
                            <input type="number" id="productPrice" step="0.01" required placeholder="29.99">
                        </div>
                        <div class="form-group">
                            <label for="productCategory">Kategori:</label>
                            <select id="productCategory" required>
                                <option value="">Kategori Se√ßin</option>
                                <option value="mobilya">Mobilya</option>
                                <option value="elektronik">Elektronik</option>
                                <option value="karakter">Karakterler</option>
                                <option value="arac">Ara√ßlar</option>
                                <option value="mimari">Mimari</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="productDescription">A√ßƒ±klama:</label>
                            <textarea id="productDescription" rows="4" required placeholder="√úr√ºn a√ßƒ±klamasƒ±nƒ± yazƒ±n..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="modelUrl">3D Model URL:</label>
                            <input type="text" id="modelUrl" placeholder="https://example.com/model.glb">
                        </div>
                        <div class="form-group">
                            <label for="productImage">√úr√ºn G√∂rsel URL:</label>
                            <input type="text" id="productImage" placeholder="https://example.com/image.jpg">
                        </div>
                        <button type="submit" class="btn-primary">√úr√ºn√º Ekle</button>
                    </form>
                    <div id="productMessage" class="message hidden"></div>
                </div>

                <!-- √úr√ºn Y√∂netimi B√∂l√ºm√º -->
                <div id="viewProducts" class="admin-section">
                    <h2>√úr√ºn Y√∂netimi</h2>
                    <div id="productsList" class="products-list">
                        <!-- √úr√ºnler buraya dinamik olarak eklenecek -->
                    </div>
                </div>

                <!-- Sipari≈üler B√∂l√ºm√º -->
                <div id="viewOrders" class="admin-section">
                    <h2>Sipari≈ü Y√∂netimi</h2>
                    <div id="ordersList" class="products-list">
                        <!-- Sipari≈üler buraya eklenecek -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // ‚úÖ T√úM ADMIN FONKSƒ∞YONLARI BURADA

        // 1. Sayfa y√ºklendiƒüinde √ßalƒ±≈üacak
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Admin sayfasƒ± y√ºklendi');
            
            // Admin kontrol√º yap
            checkAdminAccess();
            
            // Form event listener ekle
            const addProductForm = document.getElementById('addProductForm');
            if (addProductForm) {
                addProductForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    addProduct();
                });
            }
            
            // √áƒ±kƒ±≈ü butonunu ekle
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    logout();
                });
            }
            
            // ƒ∞lk √ºr√ºn listesini y√ºkle
            loadProducts();
            loadOrders();
        });

        // 2. Admin eri≈üim kontrol√º
        function checkAdminAccess() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            console.log('üîê Mevcut kullanƒ±cƒ±:', currentUser);
            
            if (!currentUser || currentUser.role !== 'admin') {
                console.error('‚ùå Admin eri≈üimi reddedildi!');
                alert('Bu sayfaya sadece admin kullanƒ±cƒ±lar eri≈üebilir!');
                window.location.href = '../index.html';
                return false;
            }
            
            console.log('‚úÖ Admin eri≈üimi onaylandƒ±:', currentUser.name);
            return true;
        }

        // 3. B√∂l√ºm deƒüi≈ütirme
        function showSection(sectionId) {
            console.log('üîÑ B√∂l√ºm deƒüi≈ütiriliyor:', sectionId);
            
            // T√ºm b√∂l√ºmleri gizle
            document.querySelectorAll('.admin-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // T√ºm butonlarƒ± pasif yap
            document.querySelectorAll('.sidebar-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Aktif b√∂l√ºm√º g√∂ster
            const activeSection = document.getElementById(sectionId);
            if (activeSection) {
                activeSection.classList.add('active');
            }
            
            // Aktif butonu i≈üaretle
            event.target.classList.add('active');
            
            // Eƒüer √ºr√ºn listesi b√∂l√ºm√ºyse, listeyi yenile
            if (sectionId === 'viewProducts') {
                loadProducts();
            } else if (sectionId === 'viewOrders') {
                loadOrders();
            }
        }

        // 4. √úr√ºn ekleme fonksiyonu
        function addProduct() {
            console.log('üì¶ √úr√ºn ekleme ba≈ülatƒ±lƒ±yor...');
            
            // Form deƒüerlerini al
            const productName = document.getElementById('productName').value;
            const productPrice = document.getElementById('productPrice').value;
            const productCategory = document.getElementById('productCategory').value;
            const productDescription = document.getElementById('productDescription').value;
            const modelUrl = document.getElementById('modelUrl').value;
            const productImage = document.getElementById('productImage').value;
            
            console.log('üìã Form verileri:', {
                productName, productPrice, productCategory, productDescription, modelUrl, productImage
            });
            
            // Validasyon
            if (!productName || !productPrice || !productCategory || !productDescription) {
                showProductMessage('L√ºtfen zorunlu alanlarƒ± doldurun!', 'error');
                return;
            }
            
            if (isNaN(productPrice) || parseFloat(productPrice) <= 0) {
                showProductMessage('Ge√ßerli bir fiyat girin!', 'error');
                return;
            }
            
            try {
                // √úr√ºnleri localStorage'dan al
                const products = JSON.parse(localStorage.getItem('products')) || [];
                
                // Yeni √ºr√ºn olu≈ütur
                const newProduct = {
                    id: Date.now().toString(),
                    name: productName,
                    price: parseFloat(productPrice),
                    category: productCategory,
                    description: productDescription,
                    modelUrl: modelUrl || '/models/default.glb',
                    image: productImage || '/images/default-product.jpg',
                    createdAt: new Date().toISOString(),
                    reviews: []
                };
                
                console.log('üÜï Yeni √ºr√ºn:', newProduct);
                
                // √úr√ºnleri g√ºncelle
                products.push(newProduct);
                localStorage.setItem('products', JSON.stringify(products));
                
                console.log('‚úÖ √úr√ºn ba≈üarƒ±yla eklendi!');
                
                // Ba≈üarƒ± mesajƒ± g√∂ster
                showProductMessage('üéâ √úr√ºn ba≈üarƒ±yla eklendi!', 'success');
                
                // Formu temizle
                document.getElementById('addProductForm').reset();
                
                // √úr√ºn listesini yenile
                loadProducts();
                
            } catch (error) {
                console.error('‚ùå √úr√ºn ekleme hatasƒ±:', error);
                showProductMessage('√úr√ºn eklenirken hata olu≈ütu!', 'error');
            }
        }

        // 5. √úr√ºnleri y√ºkleme
        function loadProducts() {
            console.log('üì• √úr√ºnler y√ºkleniyor...');
            
            try {
                const products = JSON.parse(localStorage.getItem('products')) || [];
                const container = document.getElementById('productsList');
                
                console.log('üìä Toplam √ºr√ºn sayƒ±sƒ±:', products.length);
                
                if (products.length === 0) {
                    container.innerHTML = '<p>Hen√ºz √ºr√ºn bulunmuyor.</p>';
                    return;
                }
                
                // √úr√ºnleri listele
                container.innerHTML = products.map(product => `
                    <div class="product-item">
                        <div class="product-info">
                            <h3>${product.name}</h3>
                            <p><strong>Fiyat:</strong> $${product.price}</p>
                            <p><strong>Kategori:</strong> ${product.category}</p>
                            <p><strong>A√ßƒ±klama:</strong> ${product.description}</p>
                            <p><strong>Olu≈üturulma:</strong> ${new Date(product.createdAt).toLocaleDateString()}</p>
                            <p><strong>Yorumlar:</strong> ${product.reviews ? product.reviews.length : 0}</p>
                        </div>
                        <div class="product-actions">
                            <button class="btn-primary" onclick="editProduct('${product.id}')">D√ºzenle</button>
                            <button class="btn-danger" onclick="deleteProduct('${product.id}')">Sil</button>
                        </div>
                    </div>
                `).join('');
                
                console.log('‚úÖ √úr√ºnler ba≈üarƒ±yla y√ºklendi!');
                
            } catch (error) {
                console.error('‚ùå √úr√ºn y√ºkleme hatasƒ±:', error);
                document.getElementById('productsList').innerHTML = '<p>√úr√ºnler y√ºklenirken hata olu≈ütu.</p>';
            }
        }

        // 6. √úr√ºn silme
        function deleteProduct(productId) {
            console.log('üóëÔ∏è √úr√ºn siliniyor:', productId);
            
            if (!confirm('Bu √ºr√ºn√º silmek istediƒüinizden emin misiniz?')) {
                return;
            }
            
            try {
                const products = JSON.parse(localStorage.getItem('products')) || [];
                const updatedProducts = products.filter(p => p.id !== productId);
                
                localStorage.setItem('products', JSON.stringify(updatedProducts));
                
                console.log('‚úÖ √úr√ºn silindi!');
                showProductMessage('√úr√ºn ba≈üarƒ±yla silindi!', 'success');
                
                // Listeyi yenile
                loadProducts();
                
            } catch (error) {
                console.error('‚ùå √úr√ºn silme hatasƒ±:', error);
                showProductMessage('√úr√ºn silinirken hata olu≈ütu!', 'error');
            }
        }

        // 7. √úr√ºn d√ºzenleme (basit versiyon)
        function editProduct(productId) {
            console.log('‚úèÔ∏è √úr√ºn d√ºzenleniyor:', productId);
            alert('√úr√ºn d√ºzenleme √∂zelliƒüi yakƒ±nda eklenecek! ≈ûu an i√ßin l√ºtfen √ºr√ºn√º silip yeniden ekleyin.');
        }

        // 8. Sipari≈üleri y√ºkleme
        function loadOrders() {
            console.log('üì¶ Sipari≈üler y√ºkleniyor...');
            
            try {
                const orders = JSON.parse(localStorage.getItem('orders')) || [];
                const container = document.getElementById('ordersList');
                
                console.log('üìä Toplam sipari≈ü sayƒ±sƒ±:', orders.length);
                
                if (orders.length === 0) {
                    container.innerHTML = '<p>Hen√ºz sipari≈ü bulunmuyor.</p>';
                    return;
                }
                
                // Sipari≈üleri listele
                container.innerHTML = orders.map(order => `
                    <div class="product-item">
                        <div class="product-info">
                            <h3>Sipari≈ü #${order.id.slice(-6)}</h3>
                            <p><strong>Toplam:</strong> $${order.total}</p>
                            <p><strong>Durum:</strong> ${order.status}</p>
                            <p><strong>Tarih:</strong> ${new Date(order.createdAt).toLocaleDateString()}</p>
                            <div>
                                <strong>√úr√ºnler:</strong>
                                ${order.items ? order.items.map(item => 
                                    `<div>${item.name} - ${item.quantity} x $${item.price}</div>`
                                ).join('') : '√úr√ºn bilgisi yok'}
                            </div>
                        </div>
                        <div class="product-actions">
                            <button class="btn-primary" onclick="updateOrderStatus('${order.id}', 'completed')">Tamamlandƒ±</button>
                            <button class="btn-secondary" onclick="updateOrderStatus('${order.id}', 'cancelled')">ƒ∞ptal</button>
                        </div>
                    </div>
                `).join('');
                
            } catch (error) {
                console.error('‚ùå Sipari≈ü y√ºkleme hatasƒ±:', error);
                document.getElementById('ordersList').innerHTML = '<p>Sipari≈üler y√ºklenirken hata olu≈ütu.</p>';
            }
        }

        // 9. Sipari≈ü durumu g√ºncelleme
        function updateOrderStatus(orderId, status) {
            console.log('üîÑ Sipari≈ü durumu g√ºncelleniyor:', orderId, status);
            
            try {
                const orders = JSON.parse(localStorage.getItem('orders')) || [];
                const orderIndex = orders.findIndex(o => o.id === orderId);
                
                if (orderIndex !== -1) {
                    orders[orderIndex].status = status;
                    localStorage.setItem('orders', JSON.stringify(orders));
                    
                    showProductMessage(`Sipari≈ü durumu "${status}" olarak g√ºncellendi!`, 'success');
                    loadOrders();
                }
                
            } catch (error) {
                console.error('‚ùå Sipari≈ü g√ºncelleme hatasƒ±:', error);
                showProductMessage('Sipari≈ü g√ºncellenirken hata olu≈ütu!', 'error');
            }
        }

        // 10. Mesaj g√∂sterme
        function showProductMessage(message, type) {
            console.log(`üì¢ √úr√ºn mesajƒ±: ${type} - ${message}`);
            
            const messageDiv = document.getElementById('productMessage');
            if (messageDiv) {
                messageDiv.textContent = message;
                messageDiv.className = `message ${type}`;
                messageDiv.classList.remove('hidden');
                
                setTimeout(() => {
                    messageDiv.classList.add('hidden');
                }, 5000);
            } else {
                alert(`${type.toUpperCase()}: ${message}`);
            }
        }

        // 11. √áƒ±kƒ±≈ü
        function logout() {
            console.log('üö™ √áƒ±kƒ±≈ü yapƒ±lƒ±yor...');
            localStorage.removeItem('currentUser');
            window.location.href = '../index.html';
        }
    </script>
</body>
</html>
